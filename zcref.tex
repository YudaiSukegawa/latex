\usepackage{zref-clever,zref-vario,luatexja-ruby}

\zcDeclareLanguage[allcaps]{japanese}

\zcLanguageSetup{japanese}{
  namesep   = {\nobreak} ,
  pairsep   = {と} ,
  listsep   = {，} ,
  lastsep   = {，および} ,
  tpairsep  = {および} ,
  tlistsep  = {，} ,
  tlastsep  = {，および} ,
  notesep   = {：} ,
  rangesep  = {から} ,
  type = book ,
    Name-sg = 第 ,
    Name-pl = 第 ,
    refbounds = {,,編,},
  type = part ,
    Name-sg = 第 ,
    Name-pl = 第 ,
    refbounds = {,,部,},
  type = chapter ,
    Name-sg = 第 ,
    Name-pl = 第 ,
    refbounds = {,,章,} ,
  type = section ,
    Name-sg = 第 ,
    Name-pl = 第 ,
    refbounds = {,,節,} ,
  type = paragraph ,
    Name-sg = 第 ,
    Name-pl = 第 ,
    refbounds = {,,段落,} ,
  type = appendix ,
    Name-sg = 付録 ,
    Name-pl = 付録 ,
  type = page ,
    Name-sg = p. ,
    Name-pl = pp. ,
    rangesep = {\textendash} ,
    rangetopair = false ,
  type = line ,
    Name-sg = l. ,
    Name-pl = l. ,
    rangesep = {\textendash} ,
    rangetopair = false ,
  type = figure ,
    Name-sg = 図 ,
    Name-pl = 図 ,
  type = table ,
    Name-sg = 表 ,
    Name-pl = 表 ,
  type = item ,
    Name-sg = 項目 ,
    Name-pl = 項目 ,
  type = footnote ,
    Name-sg = 脚注 ,
    Name-pl = 脚注 ,
  type = endnote ,
    Name-sg = 後注 ,
    Name-pl = 後注 ,
  type = note ,
    Name-sg = 注意 ,
    Name-pl = 注意 ,
  type = equation ,
    Name-sg = 式 ,
    Name-pl = 式 ,
    refbounds-first-sg = {,（,）,} ,
    refbounds = {,（,）,} ,
}

\zvsetup{pageprop=page}
\zvLanguageSetup{japanese}{
	reftextfaceafter = \zvhyperlink{→次ページ} ,
	reftextfacebefore = \zvhyperlink{→前ページ} ,
	reftextafter = \zvhyperlink{→次ページ} ,
	reftextbefore = \zvhyperlink{→前ページ} ,
	reftextcurrent = {} ,
	reftextfaraway = {\zvhyperlink{→\,}\zcpageref[pairsep={, }]{#1}} ,
	reftextpagerange = \zvhyperlink{→\,}\zcpageref[range]{#1,#2} ,
	reftextlabelrange = \zvhyperlink{→\,}\zcref[range]{#1,#2} ,
	vrefformat = \ltjruby[{stretchruby={0}{0}{1},stretch={0}{0}{1},intergap=-1.5}]{\zcref[]{#2}}{\zvpageref[#1]{#2}} ,
	vrefrangeformat = \ltjruby[{stretchruby={0}{0}{1},stretch={0}{0}{1},intergap=-1.5}]{\zcref[range]{#2,#3}}{\zvpagerefrange[{#1}]{#2,#3}} ,
	fullrefformat = \ltjruby[{stretchruby={0}{0}{1},stretch={0}{0}{1},intergap=-1.5}]{\zcref[]{#1}}{\reftextfaraway{#1}}
}

\zcsetup{ lang = japanese }
\newcommand{\cref}[2][]{\zvref[#1]{#2}}
